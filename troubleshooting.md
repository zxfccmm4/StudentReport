# 问题排查指南

## 常见问题及解决方案

### 1. 批量PDF生成失败

**问题描述**: 点击"批量下载"后出现错误提示

**可能原因**:
- 数据量过大导致内存不足
- 浏览器不支持HTML5 Canvas或PDF生成
- 网络连接问题影响外部库加载

**解决方案**:
1. **减少数据量**: 如果学生数量很多（>50人），建议分批处理
2. **更换浏览器**: 推荐使用Chrome或Firefox最新版本
3. **检查网络**: 确保能正常访问CDN资源
4. **清理缓存**: 清除浏览器缓存后重试
5. **关闭其他标签页**: 释放浏览器内存

### 2. Excel文件上传失败

**问题描述**: 文件拖拽或点击上传后没有反应

**可能原因**:
- 文件格式不正确
- 文件损坏或为空
- 浏览器不支持文件读取API

**解决方案**:
1. **检查文件格式**: 确保是.xlsx或.xls格式
2. **检查文件内容**: 确保文件不为空且有表头
3. **重新保存文件**: 用Excel重新保存文件
4. **使用示例数据**: 先用sample_data.html生成测试文件

### 3. 成绩数据显示异常

**问题描述**: 导入后成绩显示为0或NaN

**可能原因**:
- Excel中成绩列包含非数字字符
- 列名识别错误
- 数据格式不标准

**解决方案**:
1. **检查数据格式**: 确保成绩列只包含数字
2. **统一列名**: 使用标准的科目名称（语文、数学、英语等）
3. **清理数据**: 删除成绩列中的空格、文字等
4. **检查编码**: 确保文件使用UTF-8编码

### 4. 报告单样式异常

**问题描述**: 生成的报告单格式混乱或显示不完整

**可能原因**:
- CSS加载失败
- 字体不支持
- 浏览器兼容性问题

**解决方案**:
1. **刷新页面**: 重新加载页面
2. **检查网络**: 确保CSS文件正常加载
3. **更换浏览器**: 使用支持现代CSS的浏览器
4. **调整缩放**: 将浏览器缩放设置为100%

### 5. PDF下载质量差

**问题描述**: 下载的PDF文件模糊或不清晰

**可能原因**:
- Canvas渲染精度不够
- 图片压缩过度
- 设备像素比问题

**解决方案**:
1. **等待完全加载**: 确保页面完全加载后再下载
2. **使用桌面浏览器**: 避免在移动设备上下载
3. **关闭硬件加速**: 在浏览器设置中关闭硬件加速
4. **调整页面缩放**: 设置浏览器缩放为100%

## 浏览器兼容性

### 推荐浏览器
- ✅ Chrome 60+ (最佳支持)
- ✅ Firefox 55+ (良好支持)
- ✅ Safari 12+ (基本支持)
- ✅ Edge 79+ (良好支持)

### 不支持的浏览器
- ❌ Internet Explorer (所有版本)
- ❌ Chrome 60以下版本
- ❌ 部分移动浏览器

## 性能优化建议

### 数据量建议
- **小量数据** (1-20人): 无限制，所有功能正常
- **中等数据** (21-50人): 建议分批下载
- **大量数据** (50+人): 强烈建议分多次处理

### 设备要求
- **内存**: 建议4GB以上
- **处理器**: 建议双核以上
- **网络**: 稳定的互联网连接

## 错误代码说明

### E001: 文件读取失败
```
原因: Excel文件损坏或格式不正确
解决: 重新保存Excel文件，确保格式正确
```

### E002: 数据处理失败
```
原因: Excel数据格式不符合要求
解决: 检查数据格式，确保有正确的表头和数据
```

### E003: PDF生成失败
```
原因: 浏览器不支持或内存不足
解决: 更换浏览器或减少数据量
```

### E004: 网络资源加载失败
```
原因: 无法加载外部JavaScript库
解决: 检查网络连接，刷新页面重试
```

## 联系支持

如果以上方法都无法解决问题，请：

1. 记录错误信息和操作步骤
2. 提供使用的浏览器版本信息
3. 提供数据文件样本（去除敏感信息）
4. 联系技术支持团队

---

**提示**: 建议在正式使用前先用示例数据测试所有功能，确保系统在您的环境中正常工作。