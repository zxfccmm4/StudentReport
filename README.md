# ğŸ“ æ™ºèƒ½å­¦ç”Ÿæˆç»©æŠ¥å‘Šå•ç”Ÿæˆç³»ç»Ÿ

ä¸€ä¸ªç°ä»£åŒ–çš„å‰åç«¯åˆ†ç¦»æ¶æ„çš„å­¦ç”Ÿæˆç»©æŠ¥å‘Šå•ç”Ÿæˆç³»ç»Ÿï¼Œæ”¯æŒExcelæ–‡ä»¶å¯¼å…¥ã€æ™ºèƒ½æ•°æ®å¤„ç†å’Œç¾è§‚æŠ¥å‘Šå•ç”Ÿæˆã€‚

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Node.js](https://img.shields.io/badge/node.js-16+-green.svg)
![Express](https://img.shields.io/badge/express-4.18+-red.svg)
![Frontend](https://img.shields.io/badge/frontend-vanilla%20js-yellow.svg)


## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ¨ ç°ä»£åŒ–UIè®¾è®¡
- **ç‚«é…·è§†è§‰æ•ˆæœ**: æ¸å˜èƒŒæ™¯ã€åŠ¨ç”»ç²’å­ã€ç»ç’ƒæ€æ•ˆæœ
- **å“åº”å¼è®¾è®¡**: å®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- **æµç•…äº¤äº’**: å¹³æ»‘æ»šåŠ¨ã€åŠ¨ç”»è¿‡æ¸¡ã€å®æ—¶åé¦ˆ
- **æ·±è‰²ä¸»é¢˜**: æŠ¤çœ¼çš„æ·±è‰²ç•Œé¢è®¾è®¡

### ğŸ“Š å¼ºå¤§æ•°æ®å¤„ç†
- **æ™ºèƒ½è§£æ**: è‡ªåŠ¨è¯†åˆ«Excelæ–‡ä»¶ç»“æ„å’Œæ•°æ®æ ¼å¼
- **æ•°æ®éªŒè¯**: ä¸¥æ ¼çš„æ•°æ®æ ¡éªŒå’Œé”™è¯¯å¤„ç†
- **è‡ªåŠ¨è®¡ç®—**: æ€»åˆ†ã€å¹³å‡åˆ†ã€æ’åè‡ªåŠ¨è®¡ç®—
- **ç»Ÿè®¡åˆ†æ**: ç­çº§ç»Ÿè®¡ã€ç§‘ç›®åˆ†æã€æˆç»©åˆ†å¸ƒ

### ğŸ“„ ç¾è§‚æŠ¥å‘Šå•
- **ä¸“ä¸šè®¾è®¡**: æ¸…æ™°çš„æŠ¥å‘Šå•å¸ƒå±€å’Œæ ·å¼
- **æ™ºèƒ½è¯„è¯­**: æ ¹æ®æˆç»©è‡ªåŠ¨ç”Ÿæˆä¸ªæ€§åŒ–è¯„è¯­
- **å¤šç§æ ¼å¼**: æ”¯æŒHTMLé¢„è§ˆå’ŒPDFä¸‹è½½
- **æ‰¹é‡å¤„ç†**: ä¸€é”®ç”Ÿæˆæ‰€æœ‰å­¦ç”ŸæŠ¥å‘Šå•

### ğŸ”§ æŠ€æœ¯æ¶æ„
- **å‰åç«¯åˆ†ç¦»**: RESTful API + ç°ä»£å‰ç«¯
- **é«˜æ€§èƒ½**: å¼‚æ­¥å¤„ç†ã€å†…å­˜ä¼˜åŒ–ã€å“åº”å¼è®¾è®¡
- **æ˜“éƒ¨ç½²**: è‡ªåŠ¨åŒ–è„šæœ¬ã€ç¯å¢ƒé…ç½®ç®€å•
- **å¯æ‰©å±•**: æ¨¡å—åŒ–è®¾è®¡ã€æ˜“äºç»´æŠ¤å’Œæ‰©å±•

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js 16+ 
- npm 8+
- ç°ä»£æµè§ˆå™¨ (Chrome, Firefox, Safari, Edge)

### ä¸€é”®å¯åŠ¨

ä½¿ç”¨è‡ªåŠ¨åŒ–å¯åŠ¨è„šæœ¬ï¼š

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/zxfccmm4/StudentReport.git
cd StudentReport

# ä¸€é”®å¯åŠ¨ï¼ˆè‡ªåŠ¨å®‰è£…ä¾èµ–å¹¶å¯åŠ¨æœåŠ¡ï¼‰
./start.sh
```

### æ‰‹åŠ¨å®‰è£…

å¦‚æœéœ€è¦æ‰‹åŠ¨å®‰è£…ï¼š

```bash
# 1. å®‰è£…åç«¯ä¾èµ–
cd backend
npm install

# 2. å¯åŠ¨æœåŠ¡
npm run dev  # å¼€å‘æ¨¡å¼
# æˆ–
npm start    # ç”Ÿäº§æ¨¡å¼

# 3. è®¿é—®åº”ç”¨
# æµè§ˆå™¨æ‰“å¼€: http://localhost:3000
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
StudentReport/
â”œâ”€â”€ frontend/                      # å‰ç«¯æ–‡ä»¶
â”‚   â”œâ”€â”€ index.html                 # ä¸»é¡µé¢
â”‚   â”œâ”€â”€ sample-generator.html      # ç¤ºä¾‹æ•°æ®ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css             # æ ·å¼æ–‡ä»¶
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ app.js                # å‰ç«¯é€»è¾‘
â”œâ”€â”€ backend/                       # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ server.js                 # ExpressæœåŠ¡å™¨
â”‚   â”œâ”€â”€ package.json              # ä¾èµ–é…ç½®
â”‚   â””â”€â”€ package-lock.json         # é”å®šç‰ˆæœ¬
â”œâ”€â”€ sample_data_with_new_fields.csv   # æ–°å­—æ®µç¤ºä¾‹æ•°æ®
â”œâ”€â”€ sample_student_data.csv           # åŸºç¡€ç¤ºä¾‹æ•°æ®
â”œâ”€â”€ troubleshooting.md                # æ•…éšœæ’é™¤æŒ‡å—
â”œâ”€â”€ start.sh                          # è‡ªåŠ¨åŒ–å¯åŠ¨è„šæœ¬
â”œâ”€â”€ .gitignore                        # Gitå¿½ç•¥é…ç½®
â””â”€â”€ README.md                         # é¡¹ç›®è¯´æ˜
```

## ğŸ¯ ä½¿ç”¨æŒ‡å—

### 1. å‡†å¤‡Excelæ–‡ä»¶

ç¡®ä¿Excelæ–‡ä»¶åŒ…å«ä»¥ä¸‹åˆ—ï¼š

**å¿…éœ€åˆ—ï¼š**
- `å§“å` - å­¦ç”Ÿå§“å
- å„ç§‘ç›®æˆç»©åˆ—ï¼ˆå¦‚ï¼šè¯­æ–‡ã€æ•°å­¦ã€è‹±è¯­ç­‰ï¼‰

**å¯é€‰åˆ—ï¼š**
- `å­¦å·` - å­¦ç”Ÿå­¦å·
- `ç­çº§` - ç­çº§ä¿¡æ¯
- `æ€§åˆ«` - å­¦ç”Ÿæ€§åˆ«
- `èº«ä»½è¯å·` - å­¦ç”Ÿèº«ä»½è¯å·
- `å­¦ç”Ÿä¸Šè¯¾è¡¨ç°` - å­¦ç”Ÿè¯¾å ‚è¡¨ç°
- `è¯·å‡` - è¯·å‡å¤©æ•°
- `æ—©é€€` - æ—©é€€æ¬¡æ•°
- `å­¦æ ¡è¯¾ç¨‹æ•™è‚²ç›®æ ‡` - å­¦æ ¡æ•™è‚²ç›®æ ‡
- `å­¦ç”ŸæœŸæœ«æ€»è¯„` - æœŸæœ«æ€»è¯„
- `æ­£å¼ä¸Šè¯¾` - æ­£å¼ä¸Šè¯¾å¤©æ•°
- `å¤‡æ³¨` æˆ– `è¯„è¯­` - è‡ªå®šä¹‰è¯„è¯­

**Excelç¤ºä¾‹ï¼š**
| å§“å | å­¦å· | ç­çº§ | æ€§åˆ« | è¯­æ–‡ | æ•°å­¦ | è‹±è¯­ | ç‰©ç† | åŒ–å­¦ | å­¦ç”Ÿä¸Šè¯¾è¡¨ç° | è¯·å‡ | æ—©é€€ | æ­£å¼ä¸Šè¯¾ |
|------|------|------|------|------|------|------|------|------|--------------|------|------|----------|
| å¼ ä¸‰ | 001 | é«˜ä¸€1ç­ | ç”· | 85 | 92 | 78 | 88 | 91 | è¡¨ç°ä¼˜ç§€ | 2 | 1 | 180 |
| æå›› | 002 | é«˜ä¸€1ç­ | å¥³ | 92 | 88 | 95 | 85 | 89 | è‹±è¯­çªå‡º | 1 | 0 | 180 |

### 2. æ“ä½œæµç¨‹

1. **è®¿é—®ç³»ç»Ÿ** - åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:3000`
2. **ä¸‹è½½æ¨¡æ¿** - ç‚¹å‡»"ä¸‹è½½Excelæ¨¡æ¿"è·å–æ ‡å‡†æ¨¡æ¿
3. **ä¸Šä¼ æ–‡ä»¶** - åœ¨"æ•°æ®ä¸Šä¼ "åŒºåŸŸæ‹–æ‹½æˆ–é€‰æ‹©Excelæ–‡ä»¶
4. **é¢„è§ˆæ•°æ®** - ç³»ç»Ÿè‡ªåŠ¨è§£æå¹¶æ˜¾ç¤ºå­¦ç”Ÿæ•°æ®é¢„è§ˆ
5. **ç”ŸæˆæŠ¥å‘Š** - ç‚¹å‡»"ç”ŸæˆæŠ¥å‘Šå•"æŒ‰é’®
6. **æŸ¥çœ‹æŠ¥å‘Š** - åœ¨ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©å­¦ç”ŸæŸ¥çœ‹æŠ¥å‘Šå•
7. **ä¸‹è½½PDF** - æ”¯æŒå•ä¸ªä¸‹è½½æˆ–æ‰¹é‡ä¸‹è½½

### 3. APIæ¥å£

#### ä¸Šä¼ æ–‡ä»¶
```http
POST /api/upload
Content-Type: multipart/form-data

# è¿”å›
{
  "status": "success",
  "message": "æˆåŠŸå¯¼å…¥ 30 åå­¦ç”Ÿçš„æ•°æ®",
  "data": {
    "totalStudents": 30,
    "subjects": ["è¯­æ–‡", "æ•°å­¦", "è‹±è¯­"],
    "students": [...]
  }
}
```

#### è·å–å­¦ç”Ÿåˆ—è¡¨
```http
GET /api/students?page=1&limit=50

# è¿”å›
{
  "status": "success",
  "data": {
    "students": [...],
    "pagination": {
      "currentPage": 1,
      "totalPages": 2,
      "totalStudents": 30
    }
  }
}
```

#### ç”ŸæˆæŠ¥å‘Šå•
```http
GET /api/students/0/report

# è¿”å›
{
  "status": "success",
  "data": {
    "html": "<div class='report-card'>...</div>",
    "student": {
      "name": "å¼ ä¸‰",
      "studentId": "001"
    }
  }
}
```

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

1. **å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨**
```bash
cd backend
npm run dev
```

2. **ä¿®æ”¹å‰ç«¯ä»£ç **
- ç¼–è¾‘ `frontend/` ç›®å½•ä¸‹çš„æ–‡ä»¶
- æµè§ˆå™¨ä¼šè‡ªåŠ¨åˆ·æ–°æ˜¾ç¤ºæ›´æ”¹

### ä»£ç ç»“æ„

#### å‰ç«¯æ¶æ„
```javascript
class ModernReportGenerator {
    // ä¸»åº”ç”¨ç±»
    init()                    // åˆå§‹åŒ–
    processFile()            // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
    displayDataPreview()     // æ˜¾ç¤ºæ•°æ®é¢„è§ˆ
    generateReportHtml()     // ç”ŸæˆæŠ¥å‘Šå•HTML
    downloadSingleReport()   // ä¸‹è½½å•ä¸ªPDF
    downloadAllReports()     // æ‰¹é‡ä¸‹è½½PDF
}
```

#### åç«¯æ¶æ„
```javascript
// è·¯ç”±ç»“æ„
app.post('/api/upload')           // æ–‡ä»¶ä¸Šä¼ 
app.get('/api/students')          // è·å–å­¦ç”Ÿåˆ—è¡¨
app.get('/api/students/:id/report') // ç”Ÿæˆå•ä¸ªæŠ¥å‘Š
app.post('/api/reports/generate')    // æ‰¹é‡ç”Ÿæˆ
app.get('/api/statistics')          // ç»Ÿè®¡ä¿¡æ¯
```

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ·»åŠ æ–°çš„APIæ¥å£**
```javascript
// backend/server.js
app.get('/api/new-feature', (req, res) => {
    res.json({ status: 'success', data: {} });
});
```

2. **æ·»åŠ å‰ç«¯åŠŸèƒ½**
```javascript
// frontend/js/app.js
async newFeature() {
    const response = await fetch('/api/new-feature');
    const data = await response.json();
    // å¤„ç†å“åº”
}
```

## ğŸ¨ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹æ ·å¼ä¸»é¢˜

ç¼–è¾‘ `frontend/css/style.css` ä¸­çš„CSSå˜é‡ï¼š

```css
:root {
    --primary-color: #6366f1;     /* ä¸»é¢˜è‰² */
    --bg-primary: #0f0f23;        /* ä¸»èƒŒæ™¯è‰² */
    --text-primary: #ffffff;       /* ä¸»æ–‡å­—è‰² */
    /* æ›´å¤šå˜é‡... */
}
```

### ä¿®æ”¹æŠ¥å‘Šå•æ¨¡æ¿

ç¼–è¾‘ `generateReportHtml()` å‡½æ•°æ¥è‡ªå®šä¹‰æŠ¥å‘Šå•æ ·å¼å’Œå†…å®¹ã€‚

### ä¿®æ”¹è¯„è¯­ç”Ÿæˆé€»è¾‘

ç¼–è¾‘ `generateComment()` å‡½æ•°æ¥è‡ªå®šä¹‰è‡ªåŠ¨è¯„è¯­çš„ç”Ÿæˆè§„åˆ™ã€‚

## ğŸ“¦ éƒ¨ç½²æŒ‡å—

### ä½¿ç”¨å¯åŠ¨è„šæœ¬éƒ¨ç½²

```bash
# ç”Ÿäº§ç¯å¢ƒå¯åŠ¨
./start.sh prod

# å¼€å‘ç¯å¢ƒå¯åŠ¨
./start.sh dev

# æŸ¥çœ‹çŠ¶æ€
./start.sh status

# åœæ­¢æœåŠ¡
./start.sh stop
```

### ä¼ ç»Ÿéƒ¨ç½²

1. **å®‰è£…ä¾èµ–**
```bash
cd backend && npm install --production
```

2. **è®¾ç½®ç¯å¢ƒå˜é‡**
```bash
export PORT=3000
export NODE_ENV=production
```

3. **å¯åŠ¨æœåŠ¡**
```bash
npm start
```

### Nginxé…ç½®

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://localhost:3000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

## ğŸ”§ æ•…éšœæ’é™¤

è¯¦ç»†çš„æ•…éšœæ’é™¤æŒ‡å—è¯·æŸ¥çœ‹ [troubleshooting.md](troubleshooting.md)

### å¸¸è§é—®é¢˜

1. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
   - æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦ä¸º .xlsx æˆ– .xls
   - ç¡®è®¤æ–‡ä»¶å¤§å°ä¸è¶…è¿‡ 10MB
   - éªŒè¯Excelæ–‡ä»¶åŒ…å«å¿…éœ€çš„åˆ—

2. **æŠ¥å‘Šå•ç”Ÿæˆå¤±è´¥**
   - æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
   - ç¡®è®¤æ•°æ®æ ¼å¼æ­£ç¡®
   - å°è¯•åˆ·æ–°é¡µé¢é‡æ–°æ“ä½œ

3. **PDFä¸‹è½½é—®é¢˜**
   - ç¡®ä¿æµè§ˆå™¨æ”¯æŒ HTML5 Canvas
   - æ£€æŸ¥ç½‘ç»œè¿æ¥æ˜¯å¦ç¨³å®š
   - å°è¯•ä½¿ç”¨Chromeæˆ–Firefoxæµè§ˆå™¨

4. **æœåŠ¡å™¨å¯åŠ¨å¤±è´¥**
   - æ£€æŸ¥Node.jsç‰ˆæœ¬æ˜¯å¦ä¸º16+
   - ç¡®è®¤ç«¯å£3000æœªè¢«å ç”¨
   - æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—é”™è¯¯ä¿¡æ¯

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤Issueå’ŒPull Requestï¼

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- [Express.js](https://expressjs.com/) - åç«¯æ¡†æ¶
- [SheetJS](https://sheetjs.com/) - Excelæ–‡ä»¶å¤„ç†
- [jsPDF](https://github.com/parallax/jsPDF) - PDFç”Ÿæˆ
- [html2canvas](https://html2canvas.hertzen.com/) - HTMLè½¬å›¾ç‰‡

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: [GitHub](https://github.com/zxfccmm4/StudentReport)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/zxfccmm4/StudentReport/issues)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹æ‚¨æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼